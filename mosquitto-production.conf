# Mosquitto Production Configuration
# WITH AUTHENTICATION AND SECURITY

# NETWORK LISTENERS

# Standard MQTT (use for development/local network)
listener 1883 0.0.0.0

# Secure MQTT with TLS (production)
listener 8883 0.0.0.0
cafile /etc/mosquitto/ca_certificates/ca.crt
certfile /etc/mosquitto/certs/server.crt
keyfile /etc/mosquitto/certs/server.key
require_certificate false

# WebSocket support
listener 9001 0.0.0.0
protocol websockets

# AUTHENTICATION

# Require authentication
allow_anonymous false

# Password file
password_file /etc/mosquitto/passwd

# ACL for topic-based access control
acl_file /etc/mosquitto/acl

# PERSISTENCE

persistence true
persistence_location /var/lib/mosquitto/
autosave_interval 60
persistence_file mosquitto.db

# LOGGING

log_dest file /var/log/mosquitto/mosquitto.log
log_dest stdout

log_type error
log_type warning
log_type notice
log_type information

log_timestamp true
log_timestamp_format %Y-%m-%d %H:%M:%S

# SECURITY SETTINGS

max_connections 100
max_queued_messages 500
max_inflight_messages 20
message_size_limit 1048576

# Rate limiting
max_publish_rate 50

# QoS & PROTOCOL

max_qos 2
retain_available true
protocol_version 31
set_tcp_nodelay true
